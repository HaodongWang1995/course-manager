# 需求：学生详情页面（Student Profile）

## 基本信息
- **状态**：未开始
- **优先级**：P1
- **创建日期**：2026-02-28
- **最后更新**：2026-02-28

## 设计稿

| 端 | Figma 地址 |
|----|-----------|
| H5（移动端） | https://www.figma.com/design/kiN4DAQTZVR7zcJu9pP67a/Course-Manager?node-id=181-419&m=dev |
| PC（桌面端） | https://www.figma.com/design/kiN4DAQTZVR7zcJu9pP67a/Course-Manager?node-id=181-679&m=dev |

## 需求描述

教师在学生列表（`/teacher/students`）中点击某行右侧的"查看详情"链接，进入该学生的详情页面，查看学生综合表现、已选课程、最近提交、教师私人备注等信息。

页面需同时兼容 H5（移动端）和 PC（桌面端）两种布局。

### 设计要点

| 模块 | H5 布局 | PC 布局 |
|------|---------|---------|
| **头部** | 返回箭头 + "Student Profile" 标题 + Message 按钮 | 左侧头像 + 姓名 + Active 徽章 + ID 信息；右侧 Export Report + Message 按钮 |
| **Performance Overview** | Skill Score (85%) + Attendance (98%)；4 条技能进度条（Attendance / Homework / Participation / Grades） | Attendance (98%) + Homework (12/14) 两大 KPI 卡片 |
| **Enrolled Courses** | 课程列表（图标 + 课程名 + 进度条 + Grade） | 右侧栏课程列表（课程名 + 出勤率 + 进度条）+ "View Full Curriculum" 按钮 |
| **Teacher's Private Notes** | 笔记列表 + "Add New" 按钮 | 右侧栏笔记列表（分类 + 日期 + 内容）+ "Show History (N Notes)" 链接 |
| **Recent Submissions** | 时间轴样式 3 条记录（Graded / Pending Review / Archived） | 左侧主区域详细提交记录（图标 + 课程名 + 教师名 + 状态徽章 + View Details） |

## 验收标准

- [ ] 新增路由 `/teacher/students/:studentId`，教师可从学生列表点击进入
- [ ] PC 端两栏布局：左侧 Performance Overview + Recent Submissions，右侧 Enrolled Courses + Private Notes
- [ ] H5 端单栏布局：头部居中头像 → Performance Overview → Enrolled Courses → Teacher's Private Notes → Recent Submissions
- [ ] 新增 API 端点 `GET /api/teachers/students/:studentId` 返回学生详情（含已选课程列表）
- [ ] 所有 UI 文本支持 i18n（en + zh）
- [ ] 学生列表中的"查看详情"链接正确跳转到 `/teacher/students/:studentId`
- [ ] 现有测试不受影响（`pnpm test` 全部通过）
- [ ] TypeScript 类型检查通过（`pnpm typecheck`）

## 实现方案

### 涉及文件

**新增文件：**
- `apps/web/src/routes/(app)/teacher/students.$studentId.tsx` — 路由入口（thin wrapper）
- `apps/web/src/pages/teacher/student-detail/index.tsx` — 页面主组件
- `apps/web/src/pages/teacher/student-detail/components/` — 子组件目录
  - `profile-header.tsx` — 头部信息（H5 居中 / PC 横向布局）
  - `performance-overview.tsx` — 表现概览卡片
  - `enrolled-courses.tsx` — 已选课程列表
  - `private-notes.tsx` — 教师私人备注
  - `recent-submissions.tsx` — 最近提交时间轴

**修改文件：**
- `apps/web/src/pages/teacher/students/components/student-table.tsx` — "查看详情"链接改为跳转 `/teacher/students/$studentId`
- `apps/web/src/hooks/use-queries.ts` — 新增 `useTeacherStudentDetail(studentId)` hook
- `apps/web/src/api/client.ts` — 新增 `teacherApi.studentDetail(id)` 方法
- `apps/web/src/lib/query-keys.ts` — 新增 `teacherKeys.studentDetail` query key
- `apps/web/src/locales/en.json` — 新增 `studentDetail` namespace
- `apps/web/src/locales/zh.json` — 新增 `studentDetail` namespace
- `apps/api/src/routes/teachers.ts` — 新增 `GET /students/:studentId` 端点

### API 变更

| 方法 | 路径 | 认证 | 说明 |
|------|------|------|------|
| GET | `/api/teachers/students/:studentId` | Teacher | 返回学生详情：基本信息 + 该教师课程下的选课列表（课程名、状态、选课时间） |

**响应示例：**
```json
{
  "id": "uuid",
  "name": "Alex Johnson",
  "email": "alex@example.com",
  "avatar": null,
  "created_at": "2026-01-15T...",
  "enrollments": [
    {
      "enrollment_id": "uuid",
      "course_id": "uuid",
      "course_title": "Advanced Mathematics",
      "status": "approved",
      "created_at": "2026-02-01T..."
    }
  ]
}
```

### 数据库变更

无。现有 `users`、`enrollments`、`courses` 表已能支撑学生详情查询。

### 前端变更

- 新增 TanStack Router 文件路由 `students.$studentId.tsx`
- 页面组件遵循现有 page refactor 模式（route thin wrapper → `pages/teacher/student-detail/`）
- Performance Overview / Recent Submissions / Private Notes 模块使用 mock 占位数据（后续可扩展为真实 API）
- Enrolled Courses 使用真实 API 数据（从 `GET /api/teachers/students/:studentId` 获取）

## 任务清单

- [ ] 新增 API 端点 `GET /api/teachers/students/:studentId`
- [ ] 新增 API 单元测试
- [ ] 新增前端 API client 方法 + query key + query hook
- [ ] 创建路由文件 `students.$studentId.tsx`
- [ ] 实现页面主组件 + 5 个子组件（参照 Figma 设计稿）
- [ ] H5 / PC 响应式布局适配
- [ ] 添加 i18n 翻译（en + zh）
- [ ] 修改学生列表"查看详情"链接指向新路由
- [ ] 运行 `pnpm test` + `pnpm typecheck` 确保无回归

## 备注

- Performance 数据（技能分数、出勤率百分比）、Recent Submissions、Private Notes 当前无后端数据支持，使用前端 mock 占位数据展示 UI，后续可按需扩展为真实功能
- Figma 设计中的 "Message" 和 "Export Report" 按钮为占位功能，点击后可 toast 提示"即将推出"
- 开发时请通过 figma-mcp 工具读取设计稿细节，确保 UI 还原度
